var d={compMap:{"":{}},classNameCache:{}};var $,x=()=>{if($)return $;let e=navigator.userAgent.toLocaleLowerCase(),s=/(?:android)/.test(e),o=/(?:firefox)/.test(e),i=/(?:chrome|crios)/.test(e),a=/(safari)/.test(e),n=/(?:ipad|playbook)/.test(e)||s&&!/(?:mobile)/.test(e)||o&&/(?:tablet)/.test(e),l=/(?:iphone)/.test(e)&&!n,t=!l&&!s,r=!t,c=r&&/(micromessenger|wechat)/.test(e);return $={android:s,firefox:o,chrome:i,tablet:n,ios:l,wechat:c,pc:t,phone:r,safari:a},$};var w={hover:":hover",focus:":focus",active:":active",first:":first-child",last:":last-child",blank:":blank",checked:":checked",current:":current",disabled:":disabled","focus-within":":focus-within","focus-visible":":focus-visible","in-range":":in-range",visited:":visited",even:":nth-child(even)",odd:":nth-child(odd)","placeholder-shown":":placeholder-shown",after:"::after",before:"::before",placeholder:"::-webkit-input-placeholder",scrollbar:"::-webkit-scrollbar","scrollbar-thumb":"::-webkit-scrollbar-thumb","scrollbar-track":"::-webkit-scrollbar-track","scrollbar-button":"::-webkit-scrollbar-button","scrollbar-corner":"::-webkit-scrollbar-corner"},N={dark:"@media (prefers-color-scheme: dark)",xs:"@media screen and (min-width: 480px)",sm:"@media screen and (min-width: 640px)",md:"@media screen and (min-width: 768px)",lg:"@media screen and (min-width: 1024px)",xl:"@media screen and (min-width: 1280px)",xxl:"@media screen and (min-width: 1536px)","in-xs":"@media screen (max-width:479px) and (min-width: 0px)","in-sm":"@media screen (max-width:767px) and (min-width: 479px)","in-md":"@media screen (max-width:1023px) and (min-width: 767px)","in-lg":"@media screen (max-width:1279px) and (min-width: 1023px)","in-xl":"@media screen (max-width:1535px) and (min-width: 1279px)","in-xxl":"@media screen (max-width:9999px) and (min-width: 1535px)"},A={};function h(e,s){let o=e+"_$$_"+s,i=A[o];if(i)return i;let a={comp:void 0,compName:"",pesudo:"",pesudoName:"",media:"",mediaName:"",name:"",value:"",query:""};if(!s)return A[o]=a,a;let n=d.compMap[e];return s.split(":").forEach((t,r)=>{if(r===0){if(N[t]){a.media=N[t],a.mediaName=t;return}else if(x()[t]!==void 0){a.media=`@media screen and (min-width: ${x()[t]?"0px":"9999px"})`,a.mediaName=t;return}}r<2&&w[t]?(a.pesudo=w[t],a.pesudoName=t):!a.comp&&!a.name&&n&&n[t]?(a.comp=n[t],a.compName=t):!a.comp&&!a.name?a.name=t:a.value?a.query||(a.query=t):(a.comp&&(t=t.replace(/\((.*?)\)/g,c=>c.replace(/\,/g,"^^^"))),a.value=t)}),A[o]=a,a}var H={"(":1,";":1,":":1,"=":1},v=({css:e,name:s="",media:o="",mediaName:i="",pesudo:a="",group:n=""})=>{if(!e)return;let l=`^sty_${e}_${s}_${o}_${a}_${n}`;if(d.classNameCache[l])return;d.classNameCache[l]=!0;let t=h(n,e),r=t.value;if(!r)return;let c=r[r.length-1];if(H[c])return;c==="!"&&(r=r.replace(/(!$)/," !important")),t.media&&(o=t.media),t.mediaName&&(i=t.mediaName),t.pesudo&&(a=t.pesudo);let u=r.split("~");u.length>1&&(r=" "+u.map(p=>`"${p}"`).join(" "),r+=";"),r=r.replace(/calc\((.*?)\)/g,p=>(p=p.replace(/(-|\+|\*|\/)/g,F=>" "+F+" "),p)),r=r.replace(/\|/g," "),r=r.replace(/var\((.*?)\)/g,p=>p.replace(/(var\(|\))/g,"")),r=r.replace(/--([a-zA-Z0-9_-]*)/g,p=>`var(${p})`),r=r.replace(/\^\^\^/g,",");let m=(s||e).replace(/(\:|#|\*|!|,|\.|>|<|@|~|%|\||\$|\{|\}|\[|\]|\(|\)|\+|\*|\/)/g,p=>"\\"+p),f=n?`.\\*${n}`:"",g=document.createElement("style");if(o?g.textContent=`${o} {.${m}${f}${a} ${t.query}{${t.name}:${r}}}`:g.textContent=`.${m}${f}${a} ${t.query}{${t.name}:${r}}`,g.setAttribute("flavor-css",""),document.head.append(g),i){let p=document.createElement("style");p.textContent=`.media-${i} .${m}${f}${a} ${t.query}{${t.name}:${r}}`,p.setAttribute("flavor-css",""),document.head.append(p)}};var q={},E=e=>{let s=q[e];if(s)return s;let o=[];e=e.replace(/\n/g," ");let i=[],a=e.match(/\*(.*?)\s/g),n={};a&&a.forEach(r=>{if(r){let c=r.replace(/(\*|\s)/g,"");i.push(c),n[c]=!0}});let l=/\*(.*?)\s/g,t=e.split(l);return t.forEach((r,c)=>{if(r=r.trim(),!r)return;let u=t[c+1];c===0&&!n[r]&&o.push({cssItem:r,group:""}),n[r]&&u&&!n[u]&&o.push({cssItem:u.trim(),group:r})}),q[e]=o,o};var y=(e,s="",o="",i="",a="",n="")=>{let l=`^parser_${e}_${s}_${o}_${i}_${a}`;return d.classNameCache[l]||(d.classNameCache[l]=!0,E(e).forEach(({cssItem:t,group:r})=>{t.split(" ").filter(Boolean).forEach(c=>{let u=r,m=h(r,c);if(m.comp||(m=h("",c),u=""),m.comp){let f=m.comp(m.value.split(","));y(f,c,m.media,m.mediaName,m.pesudo,u)}else v({css:c,name:s,media:o,mediaName:i,pesudo:a,group:n})})})),e};var S={},G=(e,s,o)=>{let i=`^group_${e}_${s}_${o}`;S[i]||(S[i]=!0,d.compMap[e]||(d.compMap[e]={}),d.compMap[e][s]=a=>{let n=o;a.forEach((c,u)=>{n=n.replace(new RegExp(`(\\$${u+1})`,"g"),c)});let l=a[a.length],t=c=>{n.indexOf("$"+c)>-1&&(n=n.replace(new RegExp(`(\\$${c+1})`,"g"),l),t(c+1))};t(o.length+1);let r="";return E(n).forEach(({cssItem:c,group:u})=>{c.split(" ").forEach(m=>{let f=h(u,m);f.comp||(f=h(e,m),!f.comp&&e!==""&&u!==""&&(f=h("",m))),f.comp?f.comp(f.value.split(",")).split(" ").forEach(p=>{r+=[f.mediaName,f.pesudoName,p,f.query].filter(Boolean).join(":")+" "}):r+=m+" "})}),r})};var C=(e,s)=>{!s||(s=s.replace(`
`,""),s.trim().split(";").forEach(o=>{let[i,...a]=o.split(":");i=i.trim(),i&&G(e,i,a.join(":").trim())}))};var M="[class]",L=()=>{document.head.querySelectorAll("style[flavor-css]").forEach(e=>{e.remove()}),d.compMap={},d.classNameCache={},document.querySelectorAll("[flavor]").forEach(_),document.body.querySelectorAll(M).forEach(b)};function _(e){let s=e.getAttribute("flavor");if(s==null)return;let o="";if(e.tagName==="TEMPLATE"){let i=e.content.cloneNode(!0);i&&(o=i.textContent)}else o=e.textContent;C(s,o)}function b(e){!e||e.className&&typeof e.className=="string"&&y(e.className)}var D=()=>{let e=(o,...i)=>{let a=o.length;for(let n=0;n<a;n++){let l=o[n];if(l.type==="childList"){let t=l.target;if(T&&t.__flavorIgnore&&t.closest("[flavor-ignore]")&&!t.getAttribute("flavor-ignore")){t.__flavorIgnore=!0;return}_(t),b(t),l.addedNodes.length&&(t.querySelectorAll("[flavor]").forEach(_),t.querySelectorAll(M).forEach(b))}else l.type==="attributes"&&b(l.target)}};new MutationObserver(e).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"],characterData:!1,attributeOldValue:!1,characterDataOldValue:!1})},I=!1,T=!1,k=()=>{if(!(typeof window=="undefined"||typeof document=="undefined"||!window.location)&&!I){if(!window.MutationObserver){console.error("[flavorcss] Your Browser not supported MutationObserver");return}if(!document.body){requestAnimationFrame(k);return}document.querySelectorAll("[flavor]").forEach(_),document.body.querySelectorAll(M).forEach(e=>{b(e)}),document.body.closest&&(T=!0),D(),I=!0}};k();var O={addStyle:v,device:x,parser:y,observeClass:k,addGroup:C,mediaList:N,pesudoList:w,cache:d,reset:L};window.flavorcss=O;export{O as flavorcss};
