var u={compMap:{"":{}},classNameCache:{}};var $,x=()=>{if($)return $;let e=navigator.userAgent.toLocaleLowerCase(),t=/(?:android)/.test(e),a=/(?:firefox)/.test(e),m=/(?:chrome|crios)/.test(e),o=/(safari)/.test(e),s=/(?:ipad|playbook)/.test(e)||t&&!/(?:mobile)/.test(e)||a&&/(?:tablet)/.test(e),c=/(?:iphone)/.test(e)&&!s,n=!c&&!t,r=!n,i=r&&/(micromessenger|wechat)/.test(e),p=c&&window.screen.height>=812,l=window.location.href.indexOf("native")>-1;return $={isNeedSafeBottom:p,isNeedSafeTop:l,android:t,firefox:a,chrome:m,tablet:s,ios:c,wechat:i,pc:n,phone:r,safari:o},$};function O(e,t,a){e.comp=t[a],e.comp?e.compName=a:e.name=a}function B(e,t){b[t]?(e.media=b[t],e.mediaName=t):x()[t]!==void 0&&(e.media=`@media screen and (min-width: ${x()[t]?"0px":"9999px"})`,e.mediaName=t)}var b={all:"",print:"@media print",speech:"@media speech",fine:"@media (pointer: fine)",dark:"@media (prefers-color-scheme: dark)",xs:"@media screen and (min-width: 480px)",sm:"@media screen and (min-width: 640px)",md:"@media screen and (min-width: 768px)",lg:"@media screen and (min-width: 1024px)",xl:"@media screen and (min-width: 1280px)",xxl:"@media screen and (min-width: 1536px)","in-xs":"@media screen (max-width:479px) and (min-width: 0px)","in-sm":"@media screen (max-width:767px) and (min-width: 479px)","in-md":"@media screen (max-width:1023px) and (min-width: 767px)","in-lg":"@media screen (max-width:1279px) and (min-width: 1023px)","in-xl":"@media screen (max-width:1535px) and (min-width: 1279px)","in-xxl":"@media screen (max-width:9999px) and (min-width: 1535px)"},A={};function H(e,t){!t||(e.comp&&(t=t.replace(/\((.*?)\)/g,a=>a.replace(/\,/g,"^^^"))),e.value=t)}function g(e,t){let a=e+"_$$_"+t,m=A[a];if(m)return m;let o={comp:void 0,compName:"",pesudo:"",pesudoName:"",media:"",mediaName:"",name:"",value:"",query:""};if(!t||t[0]==="/"&&t[1]==="/")return A[a]=o,o;let s=u.compMap[e]||{},c=t.split(":");B(o,c[0]),o.mediaName&&c.shift();let n=c.length,r=c[n-1],i=n>=2?c[n-2]:"",p=[...c];return s[r]?(o.comp=s[r],o.compName=r,p.pop()):i?(O(o,s,i),H(o,r),p.pop(),p.pop()):(o.name=r,p.pop()),o.pesudo=p.join(":"),o.pesudoName=o.pesudo,A[a]=o,o}var j={"(":1,";":1,":":1,"=":1},w=({css:e,name:t="",media:a="",mediaName:m="",pesudo:o="",group:s=""})=>{if(!e)return;let c=`^sty_${e}_${t}_${a}_${o}_${s}`;if(u.classNameCache[c])return;u.classNameCache[c]=!0;let n=g(s,e),r=n.value;if(!r)return;let i=r[r.length-1];if(j[i])return;i==="!"&&(r=r.replace(/(!$)/," !important")),n.media&&(a=n.media),n.mediaName&&(m=n.mediaName),n.pesudo&&(o=n.pesudo);let p=r.split("~");p.length>1&&(r=" "+p.map(f=>`"${f}"`).join(" "),r+=";"),r=r.replace(/calc\((.*?)\)/g,f=>(f=f.replace(/(-|\+|\*|\/)/g,I=>" "+I+" "),f)),r=r.replace(/\|/g," "),r=r.replace(/var\((.*?)\)/g,f=>f.replace(/(var\(|\))/g,"")),r=r.replace(/--([a-zA-Z0-9_-]*)/g,f=>`var(${f})`),r=r.replace(/\^\^\^/g,",");let l=(t||e).replace(/(\:|#|\*|!|,|\.|>|<|@|~|%|\||\$|\{|\}|\[|\]|\(|\)|\+|\*|\/)/g,f=>"\\"+f),d=s?`.\\*${s}`:"";/^(\w|\*)/.test(o)&&(o=" "+o),o=o.replace(/\|/g," ");let h=document.createElement("style");if(a?h.textContent=`${a} {.${l}${d}${o}{${n.name}:${r}}}`:h.textContent=`.${l}${d}${o}{${n.name}:${r}}`,h.setAttribute("flavor-css",""),document.head.append(h),m){let f=document.createElement("style");f.textContent=`.media-${m} .${l}${d}${o}{${n.name}:${r}}`,f.setAttribute("flavor-css",""),document.head.append(f)}};var S={},C=e=>{let t=S[e];if(t)return t;let a=[];e=e.replace(/\n/g," ");let m=[],o=e.match(/\*(.\w?)\s/g),s={};if(o)o.forEach(r=>{if(r){let i=r.replace(/(\*|\s)/g,"");i&&(m.push(i),s[i]=!0)}});else return a.push({group:"",cssItem:e}),S[e]=a,a;let c=/\*(.*?)\s/g,n=e.split(c);return n.forEach((r,i)=>{if(r=r.trim(),!r)return;let p=n[i+1];i===0&&!s[r]&&a.push({cssItem:r,group:""}),s[r]&&p&&!s[p]&&a.push({cssItem:p.trim(),group:r})}),S[e]=a,a};var y=(e,t="",a="",m="",o="",s="")=>{let c=`^parser_${e}_${t}_${a}_${m}_${o}`;return u.classNameCache[c]||(u.classNameCache[c]=!0,C(e).forEach(({cssItem:n,group:r})=>{n.split(" ").filter(Boolean).forEach(i=>{let p=r,l=g(r,i);if(l.comp||(l=g("",i),p=""),l.comp){let d=l.comp(l.value.split(","));y(d,i,l.media,l.mediaName,l.pesudo,p)}else w({css:i,name:t,media:a,mediaName:m,pesudo:o,group:s})})})),e};var G={},k=(e,t,a)=>{let m=`^group_${e}_${t}_${a}`;G[m]||(G[m]=!0,u.compMap[e]||(u.compMap[e]={}),u.compMap[e][t]=o=>{let s=a;o.forEach((i,p)=>{s=s.replace(new RegExp(`(\\$${p+1})`,"g"),i)});let c=o[o.length],n=i=>{s.indexOf("$"+i)>-1&&(s=s.replace(new RegExp(`(\\$${i+1})`,"g"),c),n(i+1))};n(a.length+1);let r="";return C(s).forEach(({cssItem:i,group:p})=>{i.split(" ").forEach(l=>{let d=g(p,l);d.comp||(d=g(e,l),!d.comp&&e!==""&&p!==""&&(d=g("",l))),d.comp&&d.compName!==t?d.comp(d.value.split(",")).split(" ").forEach(f=>{r+=[d.query,d.mediaName,d.pesudoName,f].filter(Boolean).join(":")+" "}):r+=l+" "})}),r})};var v=(e,t)=>{!t||(t=t.replace(`
`,""),t=t.replace(/(\/\/\s)/g,"//"),t.trim().split(";").forEach(a=>{let[m,...o]=a.split(":");m=m.trim(),m&&k(e,m,o.join(":").trim())}))},L=(e,t)=>{t?v(e,t):v("",e)};var M="[class]",q=()=>{document.head.querySelectorAll("style[flavor-css]").forEach(e=>{e.remove()}),u.compMap={},u.classNameCache={},document.querySelectorAll("[flavor]").forEach(E),document.body.querySelectorAll(M).forEach(N)};function E(e){let t=e.getAttribute("flavor");if(t==null)return;let a="";if(e.tagName==="TEMPLATE"){let m=e.content.cloneNode(!0);m&&(a=m.textContent)}else a=e.textContent;v(t,a)}function N(e){!e||e.className&&typeof e.className=="string"&&y(e.className)}var D=()=>{let e=(a,...m)=>{let o=a.length;for(let s=0;s<o;s++){let c=a[s];if(c.type==="childList"){let n=c.target;if(n.__flavorIgnore&&n.closest("[flavor-ignore]")&&!n.getAttribute("flavor-ignore")){n.__flavorIgnore=!0;return}E(n),N(n),c.addedNodes.length&&(n.querySelectorAll("[flavor]").forEach(E),n.querySelectorAll(M).forEach(N))}else c.type==="attributes"&&N(c.target)}};new MutationObserver(e).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"],characterData:!1,attributeOldValue:!1,characterDataOldValue:!1})},T=!1;var _=()=>{if(!(typeof window=="undefined"||typeof document=="undefined"||!window.location)&&!T){if(!window.MutationObserver){console.error("[flavorcss] Your Browser not supported MutationObserver");return}if(!document.body){requestAnimationFrame(_);return}document.querySelectorAll("[flavor]").forEach(E),document.body.querySelectorAll(M).forEach(e=>{N(e)}),D(),T=!0}};_();var F={addStyle:w,device:x,parser:y,observeClass:_,addGroup:L,mediaList:b,cache:u,reset:q};window.flavorcss=F;export{F as flavorcss};
